{% extends "admin/base_site.html" %}
{% load i18n admin_list admin_urls %}
{% load static %}
{% load verbose_names %}


{% block extrastyle %}{{ block.super }}
<link rel="stylesheet" type="text/css" href="{% static 'test_app/tree_style.css' %}" />
{% endblock %}

{% block breadcrumbs %}


<div class="breadcrumbs">
    <a href="{% url 'admin:index' %}">{% translate 'Home' %}</a>
    &rsaquo; <a href="{% url 'admin:app_list' app_label=opts.app_label %}">{{ opts.app_config.verbose_name }}</a>
    &rsaquo; <a href="{% url opts|admin_urlname:'changelist' %}">{{ module_name }}</a>
    &rsaquo; <a href="{% url opts|admin_urlname:'change' object.pk|admin_urlquote %}">{{ object|truncatewords:"18" }}</a>
    &rsaquo; {% translate 'Tree' %}
</div>
{% endblock %}

{% block content %}
<div id="content-main">
    <ul class="object-tools">
      <li>
        <a href="{% url opts|admin_urlname:'change' object.id|admin_urlquote %}">Move to object</a>
      </li>
    </ul>
  <div id="change-tree" class="change-tree">
    <div class="tf-tree example">
        {% for i in children_categories %}
        {% if children_categories|filter_objects_by_parent:i.pk %}
        <p>{{i}}: {{children_categories|filter_objects_by_parent:i.pk}} </p>
        {% endif %}
        {% endfor %}
        <ul>
            <li>
                {% if object.parent_id %}
                    <span class="tf-nc">
                        <a href="{% url opts|admin_urlname:'preview' object.parent_id|admin_urlquote %}">Go to parent tree</a>
                    </span>
                {% else %}
                    <span class="tf-nc">
                        Нет родителя
                    </span>
                {% endif %}
                <ul>
                    {% include 'admin/test_app/cat.html' with selected_category=object descendants=object.category_parent.all %}
                </ul>
            </li>
        </ul>
    </div>
  </div>
</div>
{% endblock %}
